<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Flipped Classroom</title>
<link href="{{ url_for('static', filename='FCMain.css') }}" rel="stylesheet" type="text/css" />
<style type="text/css">
body{
	background-repeat: no-repeat;
	background-position: center -150px;
	background-image: url("{{ url_for('static', filename='images/FM Room 1.jpg') }}");
	}
</style>
<script src="{{ url_for('static', filename='SpryAssets/SpryMenuBar.js') }}" type="text/javascript"></script>
<link href="{{ url_for('static', filename='SpryAssets/SpryMenuBarHorizontal.css') }}" rel="stylesheet" type="text/css" />
</head>

<body>
<div id="MainBox" class="width2">
  <div id="MenuBar" class="width2">
      <select>
  		<option value="ER">Emergency Room</option>
  		<option value="FM">Family Medicine Clinic</option>
  		<option value="Ophtho">Ophthalmology</option>
  		<option value="Surg">Surgery</option>
	  </select>
      <ul class="MenuBarHorizontal" id="HorizontalMenu" name="HorizontalMenu">
      <li><a class="MenuBarItemSubmenu" href="#">Tools</a>
            <ul>
              <li><a href="FCEdit.html">Edit</a></li>
              <li><a href="#">Generate </a></li>
              <li><a href="FCPlay.html">Play</a></li>
              <li><a href="#">Delete Patient </a></li>
          </ul>
        </li>
        <li><a href="#">Account</a></li>
        <li><a class="MenuBarItemSubmenu" href="#">View</a>
        <ul>
              <li><a href="#">Chart </a>          </li>
          <li><a href="#">Vitals</a></li>
          <li><a href="#">Current Medications</a></li>
          </ul>
        </li>
        <li><a href="/logout">Log out</a></li>
    </ul>
    <div id="User"></div>
  </div>
  	<br />
    <div id="PatientList">
      <table id="patientTable" style="width:200px; float:left;">
      <thead>
        <tr>
          <th>id</th>
          <th>Patients</th>
        </tr>
      </thead>
      <tbody>

      </tbody>
      </table>

    </div>
    <div id="PatientChartBrief">
    </div>

</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript">
  var selectedPatientID = -1;
  var MenuBar1 = new Spry.Widget.MenuBar("HorizontalMenu", {imgDown:"{{ url_for('static', filename='SpryAssets/SpryMenuBarDownHover.gif') }}", imgRight:"{{ url_for('static', filename='SpryAssets/SpryMenuBarRightHover.gif') }}"});

  function loadPatientList() {
    $.get("/getPatientsForCurrentUser", function(data,status) {
      var obj = JSON.parse(data);

      $.each(obj, function(i, item) {
        $('#patientTable > tbody:last').append("<tr id='patient" + item.patient_id + "' class='clickableRowPatient' style='cursor:pointer;'><td class='patientID'>" + item.patient_id + "</td><td>" + item.patient_name + "</td></tr>")
      });

      $(".clickableRowPatient").click(function() {
          $(".clickableRowPatient").attr('bgcolor', 'white');
          $(this).attr('bgcolor', 'grey');
          window.selectedPatientID = $(this).find('td.patientID').html(); 
      });
    });
  };

  function loadUserName() {
    $.get("/user/getCurrentUserName", function(data,status) {
      var obj = JSON.parse(data);
      var usr = obj[0];

      $('#User').text(usr.user_name);
    });
  };

  $(document).ready(function($) {
    loadPatientList();
    loadUserName();
  });
</script>
</body>
</html>
